# 匿名文件传输网站

一个简洁的匿名文件传输网站：
- 上传文件后生成 8 位提取码。
- 其他设备打开网站输入提取码即可下载。
- 支持大文件分片上传、断点续传、上传/下载进度条。
- 文件下载次数由上传者在上传前设定，用完后将提示“文件下载次数已用完”。

## 快速开始

```bash
npm install
npm start
```

然后访问 `http://localhost:3000`。

## 功能说明

- **分片上传**：前端将文件切分为 5MB 分片逐片上传。
- **断点续传**：上传中断后，再次选择同一文件会从已上传分片继续。
- **提取码下载**：通过提取码查询文件信息并下载。
- **次数控制下载**：上传者可配置可下载次数，下载后自动扣减，次数用完即不可再下载。
- **上传容量保护**：单文件 < 5GB，且上传前检查磁盘占用阈值（上传后需 < 80%）。
- **大文件下载支持**：后端支持 HTTP Range，可断点下载。

## 目录结构

- `server.js`：后端 API 与静态服务。
- `public/`：前端页面与脚本。
- `storage/`：上传索引、临时分片与最终文件。


## 安全性与稳定性优化

- API 与静态资源统一增加基础安全响应头（如 `X-Content-Type-Options`、`X-Frame-Options`）。
- 对 JSON 请求体与分片请求体增加大小限制，避免异常大请求导致服务不稳定。
- 上传/下载接口增加更严格的参数校验（提取码格式、uploadId、分片索引范围等）。
- 下载 Range 请求做合法性校验，非法 Range 返回错误，避免异常读取。
- 服务端增加请求超时与 `clientError` 处理，降低异常连接对服务可用性的影响。
- 前端对关键网络请求增加超时与异常提示，提升弱网场景稳定性。
